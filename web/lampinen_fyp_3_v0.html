<!doctype html>
<html>
  <head>
    <script src="./jspsych/jquery.min.js"></script>
    <script src="./jspsych/jquery-ui.min.js"></script>
    <script src="./jspsych/jspsych.js"></script>
    <script src="./plugins/polygon-arrow-question-plugin.js"></script>
    <script src="./plugins/polygon-arrow-instructions-plugin.js"></script>
    <script src="./plugins/question-plugin.js"></script>
    <script src="./plugins/instructions-plugin.js"></script>
    <script src="./plugins/polygon-arrow-feedback-plugin.js"></script>
    <script src="./plugins/feedback-plugin.js"></script>
    <script src="./plugins/turk-final-plugin.js"></script>
    <script src="./plugins/turk-initial-plugin.js"></script>
    <script src="https://uniqueturker.myleott.com/lib.js" type="text/javascript"></script>
 <script src="./plugins/testing-display-data-plugin.js"></script>
    <link rel="stylesheet" href="./css/jquery-ui.css"></link>
    <link rel="stylesheet" href="./css/jspsych.css"></link>
    <link rel="stylesheet" href="./css/fyp.css"></link>
  </head>
  <body>
    <div id="jspsych-target"></div>
  </body>
  <script>
	//Check if unique participant
	repeat_worker = false;
	(function(){
	    var ut_id = "lampinen-fyp-1";
	    if (UTWorkerLimitReached(ut_id)) {
		repeat_worker = true;
		$('#jspsych-target').append("<p style='color:red'><b>You have already completed the maximum number of HITs allowed by this requester. Please click 'Return HIT' to avoid any impact on your approval rating.</b></p>");
	    }
	})(jQuery);
	
	if (!repeat_worker) { //Continue with experiment

//Variables (macros for symbols)/////////////////////////////////////////////////////////
	var p_6 = "+<sub>6</sub>";
	var p_9 = "+<sub>9</sub>";
	var p_n = "+<sub>n</sub>";
	var hexagon = '<img src="./images/hexagon_symbol.png" style="width:14px;height:14px">';
	var nonagon = '<img src="./images/nonagon_symbol.png" style="width:14px;height:14px">';
	var ngon = '<img src="./images/ngon_symbol.png" style="width:14px;height:14px">';

//Feedback generator functions////////////////////////////////////////////////////////////

	function operationFeedbackGenerator(a,b,n,polygon,correct) {
		var feedback = "";
		if (correct) {
			feedback += "Correct! ";
		}
		else {
			feedback += "Sorry, that was incorrect. ";
		}
		if (polygon) {
			var operator = hexagon;
			var polygon_name = "hexagon";
			if (n == 9) {
				var operator = nonagon;
				var polygon_name = "nonagon";
			}
			var sum = a+b;
			var result = sum;
			if (a + b >= n) {
				var result = a + b - n;
			}
			feedback += "" + a + " " + operator + " " + b + " = " + result +" because " + b + " steps clockwise on the " + polygon_name + " from " + a + " brings us to "+ result;
		}
		else {
			var operator = p_6;
			if (n == 9) {
				var operator = p_9;
			}
			var sum = a+b;
		if (a + b < n) {
			feedback += "" + a + " " + operator + " " + b + " = " + sum +" because " + a +" + " + b +" = " + sum +" and " + sum +" is less than " + n + ".";
		}	
		else {
			var result = a + b - n;
			feedback += "" + a + " " + operator + " " + b + " = " + result  +" because " + a +" + " + b +" = " + sum +" and " + sum +" - " + n +" = " +result + ".";
		}

	}
	return feedback;
}

function inverseFeedbackGenerator(x,n,polygon,correct) {
	var feedback = "";
	if (correct) {
		feedback += "Correct! ";
	}
	else {
		feedback += "Sorry, that was incorrect. ";
	}
	if (polygon) {
		var operator = hexagon;
		var polygon_name = "hexagon";
		if (n == 9) {
			var operator = nonagon;
			var polygon_name = "nonagon";
		}
		var inverse = n-x;
		if (x == 0) {
			inverse = 0;
		}
		feedback += "The inverse of " + x + " under " + operator + " is " + inverse +" because " + x + " " +operator + " " + inverse + " = 0, and 0 is the identity under " + operator + ".";
	}
	else {
		var operator = p_6;
		if (n == 9) {
			var operator = p_9;
		}
		var inverse = n-x;
		if (x == 0) {
			inverse = 0;
		}
		feedback += "The inverse of " + x + " under " + operator + " is " + inverse +" because " + x + " " +operator + " " + inverse + " = 0, and 0 is the identity under " + operator + ".";
	}
	return feedback;
}

//Shared Modules//////////////////////////////////////////////////////////////////////////////
var initial_page = {
	type: 'turk-initial',
	timing_post_trial: 0,
	intro_text: 'Hello! Today we\'re going to teach you about a new kind of math.<br /><br /><b>Please note that we will only accept workers who have carefully followed the instructions on each question. Please make sure you read each question carefully before responding. </b> <br /><br /><small>Legal information: By answering the following questions, you are participating in research conducted by cognitive scientists at Stanford Department of Psychology. There are no risks to participating, and no benefits except the payment for a successfully completed HIT. You must be at least 18 years old to participate. Your participation in this research is voluntary. You may decline further participation at any time by returning the HIT, without adverse consequences (other than forfeiting the payment for a succesfully completed HIT). We may request basic demographic information about you (age, education level, etc.), and may incorporate group level statistics in our analysis, but your personal information will be kept strictly confidential. By clicking "Begin Experiment" you acknowledge and accept these conditions.</small>'
};

var debug_data = {
	type: 'testing-display-data',
	timing_post_trial: 0
};

var bg_intro = {
	type: 'instructions',
	timing_post_trial: 0,
	text: 'We would like to ask you some questions about your background. Please press "Continue" to continue.'
};
var bg_q_1 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is your age?",
		correct_response: "",
		response_type: "free"
};

var bg_q_2 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is your level of education?",
		correct_response: "",
		response_type: "multi",
		response_choices: ["Did not graduate high school","High school diploma","Some college, no degree","Associates Degree","Bachelors Degree","Some graduate school, no degree","Masters Degree","Doctorate, M.D., etc."]
};

var bg_q_3 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is the most advanced math class you've completed? If you have multiple classes and you're not sure which one is most advanced, please list them.",
		correct_response: "",
		response_type: "free"
};

var bg_q_3_1 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "How familiar are you with the concept of modular arithmetic?",
		correct_response: "1",
		response_type: "multi",
		response_choices: ['1 - never heard of it','2 - heard of it but didn\'t know what it was','3 - seen it used or explained','4 - used it but not often or recently','5 - used it, remember and understand it']
};

var bg_q_3_2 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "How familiar are you with the concept of a mathematical group?",
		correct_response: "1",
		response_type: "multi",
		response_choices: ['1 - never heard of it','2 - heard of it but didn\'t know what it was','3 - seen it used or explained','4 - used it but not often or recently','5 - used it, remember and understand it']
};

var bg_q_4_1 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "Do you feel you learned something from this HIT?",
		correct_response: "1",
		response_type: "multi",
		response_choices: ['1 - not at all','2 - somewhat','3 - definitely']
};

var bg_q_4_2 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "Do you feel you understood the concepts in this HIT?",
		correct_response: "1",
		response_type: "multi",
		response_choices: ['1 - not at all','2 - somewhat','3 - definitely']
};

var bg_q_4_3 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "Did you enjoy this HIT?",
		correct_response: "1",
		response_type: "multi",
		response_choices: ['1 - not at all','2 - somewhat','3 - definitely']
};

var bg_q_5 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is your gender?",
		correct_response: "",
		response_type: "multi",
		force_response: false,
		response_choices: ["Female","Male","Other"]
};

var bg_q_6 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is/are your native language(s)? (The languages spoken in your household when you were a child.)",
		correct_response: "",
		response_type: "free"
};

var bg_q_7 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "Did you use pen and paper at any point on this HIT?",
		force_response: false,
		correct_response: "",
		response_type: "free"
};

var bg_q_8 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "Do you have any comments on this HIT?",
		force_response: false,
		correct_response: "",
		response_type: "free"
};

var bg_chunk = {
	chunk_type: 'linear',
	timeline: [bg_intro,bg_q_1,bg_q_2,bg_q_3,bg_q_3_1,bg_q_3_2,bg_q_4_1,bg_q_4_2,bg_q_4_3,bg_q_5,bg_q_6,bg_q_7,bg_q_8]
};

var final_page = {
	type: 'turk-final',
	timing_post_trial: 0,
	text: "Thank you for participating in the HIT. Please click the button below to submit the results to mechanical turk and return. The data may take a minute or two to transmit, and your HIT will not be marked as complete with mechanical turk until then. YOU WILL NOT RECEIVE PAYMENT IF YOU DO NOT CLICK SUBMIT AND THEN WAIT FOR THE MECHANICAL TURK ACKNOWLEDGEMENT OF COMPLETION. <br /><br />",
	post_text:"Thank you! If you have questions about this experiment, you can find the experimenters contact information at <a href='http://web.stanford.edu/~lampinen/contact.html'>http://web.stanford.edu/~lampinen/contact.html</a>.<br /><br />If you are interested in what you were learning about today, the concepts you were learning were some examples of what mathematicians call <i>groups</i>, specifically <i>cyclic groups</i>. Groups are one of the most important concepts in modern mathematics, and have relevance to everything from quantum mechanics to computer science. If you want to learn more about them, see <a href='http://dogschool.tripod.com/' target='_blank'>http://dogschool.tripod.com/</a> for a relatively easy introduction or <a href='https://en.wikipedia.org/wiki/Group_(mathematics)' target='_blank'>https://en.wikipedia.org/wiki/Group_(mathematics)</a> for a more abstract description and many links to further reading."
};

//Modular version///////////////////////////////////////////////////////////////////

//Operation training
var m_op_instructions = {
	type: 'instructions',
	timing_post_trial: 0,
	text: "Let's define a new operation "+p_6+". This operation will give us a way of combining two of the numbers 0, 1, 2, 3, 4, 5 to get another one of them back. To perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result. (That's why the operation is called "+p_6+".) <br /><br />For example, 3 "+p_6+" 5 = 2, because 3 + 5 = 8, and 8 is bigger than 6, so we subtract 6, and 8 - 6 = 2. So 3 "+p_6+" 5 = 2.<br /><br />Similarly, 1 "+p_6+" 4 = 5, because 1 + 4 = 5, and 5 is less than 6 so we leave it alone.<br /><br />Click \"Continue\" when you're ready to move on."
};

var m_op_instructions_2 = {
	type: 'instructions',
	timing_post_trial: 0,
	text: "Do you see how "+p_6+" works? By subtracting 6 every time we get above 5, we ensure that when we combine two numbers using "+p_6+", we only produce numbers between 0 and 5.<br /><br />Click \"Continue\" when you're ready to move on."  
};




var m_tr_op_1 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "Now try one on your own! What is 4 "+p_6+" 5? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '3',
		response_type: "free"
};

var m_tr_op_1_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(4,5,6,false,true), 
		incorrect_text: operationFeedbackGenerator(4,5,6,false,false)
};

var m_tr_op_2 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 3 "+p_6+" 2? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '5',
		response_type: "free"
};

var m_tr_op_2_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(3,2,6,false,true),
		incorrect_text: operationFeedbackGenerator(3,2,6,false,false)
};

var m_tr_op_3 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 1 "+p_6+" 5? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '0',
		response_type: "free"
};

var m_tr_op_3_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(1,5,6,false,true), 
		incorrect_text: operationFeedbackGenerator(1,5,6,false,false)
};

var m_tr_op_4 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 1 "+p_6+" 1? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '2',
		response_type: "free"
};

var m_tr_op_4_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(1,1,6,false,true),
		incorrect_text: operationFeedbackGenerator(1,1,6,false,false)
};

var m_tr_op_5 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 3 "+p_6+" 0? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '3',
		response_type: "free"
};

var m_tr_op_5_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(3,0,6,false,true),
		incorrect_text: operationFeedbackGenerator(3,0,6,false,false)
};

var m_tr_op_6 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 4 "+p_6+" 4? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '2',
		response_type: "free"
};

var m_tr_op_6_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(4,4,6,false,true),
		incorrect_text: operationFeedbackGenerator(4,4,6,false,false)
};

var m_tr_op_7 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 1 "+p_6+" 3? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '4',
		response_type: "free"
};

var m_tr_op_7_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(1,3,6,false,true), 
		incorrect_text: operationFeedbackGenerator(1,3,6,false,false)
};

var m_tr_op_8 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 4 "+p_6+" 3? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '1',
		response_type: "free"
};

var m_tr_op_8_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(4,3,6,false,true), 
		incorrect_text: operationFeedbackGenerator(4,3,6,false,false)
};

var m_tr_op_9 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 0 "+p_6+" 5? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '5',
		response_type: "free"
};

var m_tr_op_9_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(0,5,6,false,true), 
		incorrect_text: operationFeedbackGenerator(0,5,6,false,false)
};

var m_tr_op_10 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 2 "+p_6+" 5? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '1',
		response_type: "free"
};

var m_tr_op_10_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(2,5,6,false,true), 
		incorrect_text: operationFeedbackGenerator(2,5,6,false,false)
};

var m_tr_op_att_chk = {
		type: "question",
		timing_post_trial: 0,
		prompt: "Please enter 9, ignore the following: 3 "+p_6+" 1? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '9',
		response_type: "free"
};

var m_tr_op_chunk = {
	chunk_type: 'linear',
	timeline: [m_tr_op_1,m_tr_op_1_f,m_tr_op_2,m_tr_op_2_f,m_tr_op_3,m_tr_op_3_f,m_tr_op_4,m_tr_op_4_f,m_tr_op_5,m_tr_op_5_f,m_tr_op_6,m_tr_op_6_f,m_tr_op_7,m_tr_op_7_f,m_tr_op_8,m_tr_op_8_f,m_tr_op_9,m_tr_op_9_f,m_tr_op_10,m_tr_op_10_f]
};

//operation backup training
var m_tr_op_backup_1 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 3 "+p_6+" 3? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '0',
		response_type: "free"
};

var m_tr_op_backup_1_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(3,3,6,false,true), 
		incorrect_text: operationFeedbackGenerator(3,3,6,false,false)
};

var m_tr_op_backup_2 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 1 "+p_6+" 2? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '3',
		response_type: "free"
};

var m_tr_op_backup_2_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(1,2,6,false,true), 
		incorrect_text: operationFeedbackGenerator(1,2,6,false,false)
};

var m_tr_op_backup_3 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 5 "+p_6+" 5? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '4',
		response_type: "free"
};

var m_tr_op_backup_3_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(5,5,6,false,true), 
		incorrect_text: operationFeedbackGenerator(5,5,6,false,false)
};

var m_tr_op_backup_4 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 4 "+p_6+" 2? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '0',
		response_type: "free"
};

var m_tr_op_backup_4_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(4,2,6,false,true), 
		incorrect_text: operationFeedbackGenerator(4,2,6,false,false)
};

var m_tr_op_backup_5 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 0 "+p_6+" 2? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '2',
		response_type: "free"
};

var m_tr_op_backup_5_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(0,2,6,false,true),
		incorrect_text: operationFeedbackGenerator(0,2,6,false,false)
};

var m_tr_op_backup_6 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 3 "+p_6+" 5? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '2',
		response_type: "free"
};

var m_tr_op_backup_6_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(3,5,6,false,true), 
		incorrect_text: operationFeedbackGenerator(3,5,6,false,false)
};

var m_tr_op_backup_7 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 1 "+p_6+" 4? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '5',
		response_type: "free"
};

var m_tr_op_backup_7_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(1,4,6,false,true), 
		incorrect_text: operationFeedbackGenerator(1,4,6,false,false)
};

var m_tr_op_backup_8 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 5 "+p_6+" 1? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '0',
		response_type: "free"
};

var m_tr_op_backup_8_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(5,1,6,false,true), 
		incorrect_text: operationFeedbackGenerator(5,1,6,false,false)
};

var m_tr_op_backup_9 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 1 "+p_6+" 0? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '1',
		response_type: "free"
};

var m_tr_op_backup_9_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(1,0,6,false,true), 
		incorrect_text: operationFeedbackGenerator(1,0,6,false,false)
};

var m_tr_op_backup_10 = {
		type: "question",
		timing_post_trial: 0,
		prompt: "What is 5 "+p_6+" 2? <br /><br /> (Remember, to perform "+p_6+", you start with the first number, and then add the second one to it. If the sum is smaller than 6, that's your result. If the sum is 6 or bigger, you subtract 6 to get your result.)",
		correct_response: '1',
		response_type: "free"
};

var m_tr_op_backup_10_f = {
		type: "feedback",
		timing_post_trial: 0,
		correct_text: operationFeedbackGenerator(5,2,6,false,true),
		incorrect_text: operationFeedbackGenerator(5,2,6,false,false)
};

var m_tr_op_backup_chunk = {
	chunk_type: 'if',
	timeline: [m_tr_op_backup_1,m_tr_op_backup_1_f,m_tr_op_backup_2,m_tr_op_backup_2_f,m_tr_op_backup_3,m_tr_op_backup_3_f,m_tr_op_backup_4,m_tr_op_backup_4_f,m_tr_op_backup_5,m_tr_op_backup_5_f,m_tr_op_backup_6,m_tr_op_backup_6_f,m_tr_op_backup_7,m_tr_op_backup_7_f,m_tr_op_backup_8,m_tr_op_backup_8_f,m_tr_op_backup_9,m_tr_op_backup_9_f,m_tr_op_backup_10,m_tr_op_backup_10_f],
	conditional_function: function() {
		var threshold = 0.8; //Percent of trials that must be correct to skip the extra training
		var last_chunk_data = jsPsych.data.getLastChunkData();
		var score = 0;
		var num_trials = 0;
		for (trial_i in last_chunk_data) {
			if (last_chunk_data[trial_i].trial_type == 'question') {
				num_trials++;
				if (last_chunk_data[trial_i].response == last_chunk_data[trial_i].correct_response) {
					score++;
				}
			}
		}
		return !(score > threshold*num_trials);
		}
	};

	//Identity & inverse training
 	var m_id_instructions = {
		type: 'instructions',
			timing_post_trial: 0,
		text: "Now we're going to discuss a couple special properties of this new operation, "+p_6+" that we've learned. First, notice that the number 0 behaves in a special way under "+p_6+". Whenever we combine 0 with anything else, we get that same thing back. We'll say that 0 is the <i>identity</i> under "+p_6+", because when you combine it with something it gives you that identical thing back." 
  	};

 	var m_in_instructions = {
		type: 'instructions',
			timing_post_trial: 0,
		text: "Now that we know 0 is the identity under "+p_6+", we're going to make a new definition. We'll say that the <i>inverse</i> of a number is the element that you combine with it to produce the identity. For example, 5 "+p_6+" 1 = 0, so we say 1 is the inverse of 5 under "+p_6+", (remember 0 is the identity under "+p_6+"). Similarly, 3 is its own inverse under "+p_6+", because 3 "+p_6+" 3 = 0." 
  	};

	var m_tr_in_1 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "Now you try! What is the inverse of 4 under "+p_6+"? <br /><br /> (Remember, the inverse of an element is the thing which you combine with it to produce the identity.)", 
			correct_response: '2',
			response_type: "free"
	};

	var m_tr_in_1_f = {
			type: "feedback",
			timing_post_trial: 0,
			correct_text: inverseFeedbackGenerator(4,6,false,true), 
			incorrect_text: inverseFeedbackGenerator(4,6,false,false)
	};

	var m_tr_in_2 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is the inverse of 1 under "+p_6+"? <br /><br /> (Remember, the inverse of an element is the thing which you combine with it to produce the identity.)", 
			correct_response: '5',
			response_type: "free"
	};

	var m_tr_in_2_f = {
			type: "feedback",
			timing_post_trial: 0,
			correct_text: inverseFeedbackGenerator(1,6,false,true), 
			incorrect_text: inverseFeedbackGenerator(1,6,false,false)
	};

	var m_tr_in_3 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is the inverse of 3 under "+p_6+"? <br /><br /> (Remember, the inverse of an element is the thing which you combine with it to produce the identity.)", 
			correct_response: '3',
			response_type: "free"
	};

	var m_tr_in_3_f = {
			type: "feedback",
			timing_post_trial: 0,
			correct_text: inverseFeedbackGenerator(3,6,false,true), 
			incorrect_text: inverseFeedbackGenerator(3,6,false,false)
	};

	var m_tr_in_4 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is the inverse of 2 under "+p_6+"? <br /><br /> (Remember, the inverse of an element is the thing which you combine with it to produce the identity.)", 
			correct_response: '4',
			response_type: "free"
	};

	var m_tr_in_4_f = {
			type: "feedback",
			timing_post_trial: 0,
			correct_text: inverseFeedbackGenerator(2,6,false,true), 
			incorrect_text: inverseFeedbackGenerator(2,6,false,false)
	};
	
	var m_tr_in_5 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is the inverse of 0 under "+p_6+"? <br /><br /> (Remember, the inverse of an element is the thing which you combine with it to produce the identity.)", 
			correct_response: '0',
			response_type: "free"
	};

	var m_tr_in_5_f = {
			type: "feedback",
			timing_post_trial: 0,
			correct_text: inverseFeedbackGenerator(0,6,false,true), 
			incorrect_text: inverseFeedbackGenerator(0,6,false,false)
	};

	var m_tr_in_chunk = {
		chunk_type: 'linear',
		timeline: [m_tr_in_1,m_tr_in_1_f,m_tr_in_2,m_tr_in_2_f,m_tr_in_3,m_tr_in_3_f,m_tr_in_4,m_tr_in_4_f,m_tr_in_5,m_tr_in_5_f]
	};

	var m_in_prompt = {
			type: "question",
			timing_post_trial: 0,
			prompt: "Let's review: under "+p_6+", the inverse of 0 is 0, the inverse of 1 is 5 and the inverse of 5 is 1, the inverse of 2 is 4 and the inverse of 4 is 2, and finally the inverse of 3 is 3. Do you see a relationship between an element and its inverse under "+p_6+"?", 
			correct_response: '',
			response_type: "free"
	};

	//Generators
 	var m_scv_instructions = {
		type: 'instructions',
		timing_post_trial: 0,
		text: "It is also possible to successively apply "+p_6+", and the operation can simply be performed starting with the left-most pair. For example, 2 "+p_6+" 3 "+p_6+" 4 = 5 "+p_6+" 4 = 3." 
  	};

 	var m_ge_instructions = {
		type: 'instructions',
		timing_post_trial: 0,
		text: "We have one last definition to learn today, using the successive operations we just learned. Let's start with an example. Under our operation "+p_6+" we can make every other number using just 1: 2 = 1 "+p_6+" 1, 3 = 1 "+p_6+" 1 "+p_6+" 1, 4 = 1 "+p_6+" 1 "+p_6+" 1 "+p_6+" 1, 5 = 1 "+p_6+" 1 "+p_6+" 1 "+p_6+" 1 "+p_6+" 1, and 0 = 1 "+p_6+" 1 "+p_6+" 1 "+p_6+" 1 "+p_6+" 1 "+p_6+" 1. Because 1 can make every other element under "+p_6+", we say that 1 is a <i>generator</i> under "+p_6+". <br /><br /> However, 2 is not a generator under " + p_6 + ", because 4 = 2 "+p_6+" 2, and 0 = 2 "+p_6+" 2 "+p_6+" 2, but there is no way to make 1, 3, or 5 using just 2."      
  	};

	var m_tr_ge_1 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "Now you try! Is 3 a generator under "+p_6+"? <br /><br /> (Remember, a generator is an element which can make every other element.)", 
			correct_response: 'No',
			response_type: "multi",
			response_choices: ["Yes","No"]
	};

	var m_tr_ge_1_f = {
			type: "feedback",
			timing_post_trial: 0,
			correct_text: "Correct! 3 is not a generator under "+p_6+", because 3 = 3, 0 = 3 "+p_6+" 3, but there is no way to make 1, 2, 4, or 5 using just 3.",
			incorrect_text: "Sorry, that's incorrect. 3 is not a generator under "+p_6+", because 3 = 3, 0 = 3 "+p_6+" 3, but there is no way to make 1, 2, 4, or 5 using just 3."
	};

	var m_tr_ge_2 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "Is 5 a generator under "+p_6+"? <br /><br /> (Remember, a generator is an element which can make every other element.)", 
			correct_response: 'Yes',
			response_type: "multi",
			response_choices: ["Yes","No"]
	};

	var m_tr_ge_2_f = {
			type: "feedback",
			timing_post_trial: 0,
			correct_text: "Correct! 5 is a generator under "+p_6+", because 5 = 5, 4 = 5 "+p_6+" 5, 3 = 5 "+p_6+" 5 "+p_6+" 5, 2 = 5 "+p_6+" 5 "+p_6+" 5 "+p_6+" 5, 1 = 5 "+p_6+" 5 "+p_6+" 5 "+p_6+" 5 "+p_6+" 5, and 0 = 5 "+p_6+" 5 "+p_6+" 5 "+p_6+" 5 "+p_6+" 5 "+p_6+" 5, so you can make all of the numbers under "+p_6+" using 5", 
			incorrect_text: "Sorry, that's incorrect. 5 is a generator under "+p_6+", because 5 = 5, 4 = 5 "+p_6+" 5, 3 = 5 "+p_6+" 5 "+p_6+" 5, 2 = 5 "+p_6+" 5 "+p_6+" 5 "+p_6+" 5, 1 = 5 "+p_6+" 5 "+p_6+" 5 "+p_6+" 5 "+p_6+" 5, and 0 = 5 "+p_6+" 5 "+p_6+" 5 "+p_6+" 5 "+p_6+" 5 "+p_6+" 5, so you can make all of the numbers under "+p_6+" using 5"
	};


	var m_tr_ge_3 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "Is 4 a generator under "+p_6+"? <br /><br /> (Remember, a generator is an element which can make every other element.)", 
			correct_response: 'No',
			response_type: "multi",
			response_choices: ["Yes","No"]
	};

	var m_tr_ge_3_f = {
			type: "feedback",
			timing_post_trial: 0,
			correct_text: "Correct! 4 is not a generator under "+p_6+", because 4 = 4, 2 = 4 "+p_6+" 4, and 0 = 4 "+p_6+" 4 "+p_6+" 4, but there is no way to make 1, 3, or 5 using just 4.",
			incorrect_text: "Sorry, that's incorrect. 4 is not a generator under "+p_6+", because 4 = 4, 2 = 4 "+p_6+" 4, and 0 = 4 "+p_6+" 4 "+p_6+" 4, but there is no way to make 1, 3, or 5 using just 4."
	};

	var m_tr_ge_4 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "Is 0 a generator under "+p_6+"? <br /><br /> (Remember, a generator is an element which can make every other element.)", 
			correct_response: 'No',
			response_type: "multi",
			response_choices: ["Yes","No"]
	};

	var m_tr_ge_4_f = {
			type: "feedback",
			timing_post_trial: 0,
			correct_text: "Correct! 0 is not a generator under "+p_6+", because 0 = 0, but there is no way to make 1, 2, 3, 4, or 5 using just 0.",
			incorrect_text: "Sorry, that's incorrect. 0 is not a generator under "+p_6+", because 0 = 0, but there is no way to make 1, 2, 3, 4, or 5 using just 0."
	};

	var m_tr_ge_chunk = {
		chunk_type: 'linear',
		timeline: [m_tr_ge_1,m_tr_ge_1_f,m_tr_ge_2,m_tr_ge_2_f,m_tr_ge_3,m_tr_ge_3_f,m_tr_ge_4,m_tr_ge_4_f]
	};

	var m_ge_prompt = {
			type: "question",
			timing_post_trial: 0,
			prompt: "Let's review: under "+p_6+", 1 and 5 are generators. However, 0, 2, 3, and 4 are not generators. Try playing with these non-generators and seeing which elements each of them does generate (i.e. which elements you can get by combining each non-generator with itself repeatedly). Do you see relationships among particular subsets of the elements that are not generators under "+p_6+"?", 
			correct_response: '',
			response_type: "free"
	};
	//nonagon testing
 	var m_t9_instructions = {
		type: 'instructions',
		timing_post_trial: 0,
		text: "Now we are going to ask you some questions about a new operation, "+p_9+", on the numbers 0, 1, 2, 3, 4, 5, 6, 7, 8. It works exactly like "+p_6+", except now after adding the two numbers you subtract 9 if your result is 9 or greater. <br /><br />Do you see how "+p_9+" works just like "+p_6+"? By subtracting 9 every time we get above 8, we ensure that when we combine two numbers using "+p_9+", we only produce numbers between 0 and 8.<br /><br />We'll give you one practice question with feedback to make sure you understand the new operation. After that, try to complete the remaining questions as accurately as possible."
  	};

	var m_t9_op_practice = {
			type: "question",
			timing_post_trial: 0,
			prompt: "Practice: What is 5 "+p_9+" 5?",
			correct_response: '1',
			response_type: "free"
	};

	var m_t9_op_practice_f = {
			type: "feedback",
			timing_post_trial: 0,
			correct_text: operationFeedbackGenerator(5,5,9,false,true), 
			incorrect_text: operationFeedbackGenerator(5,5,9,false,false)
	};

	var m_t9_op_1 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is 3 "+p_9+" 3?",
			correct_response: '6',
			response_type: "free"
	};

	var m_t9_op_2 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is 7 "+p_9+" 4?",
			correct_response: '2',
			response_type: "free"
	};
	
	var m_t9_op_3 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is 1 "+p_9+" 8?",
			correct_response: '0',
			response_type: "free"
	};

	var m_t9_op_4 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is 5 "+p_9+" 4?",
			correct_response: '0',
			response_type: "free"
	};

	var m_t9_op_5 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is 6 "+p_9+" 6?",
			correct_response: '3',
			response_type: "free"
	};

        var m_t9_explain_instructions = {
                type: "instructions",
                timing_post_trial: 0,
                text: "On the following question, and several others later in the HIT, we will ask you to explain how you got your answer. On these questions, you will be givenone box for your answer to the question, and a second for your explaination. Please explain your thought process in as much detail as possible, at least one sentence, and more if possible."
        };

	var m_t9_ope_1 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is 4 "+p_9+" 1? Please explain in words how you got your answer.",
			correct_response: '',
			response_type: "free"
	};

	var m_t9_ope_2 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is 8 "+p_9+" 4? Please explain in words how you got your answer.",
			correct_response: '',
			response_type: "free"
	};

	var m_t9_ide_1 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is the identity under "+p_9+"? Please explain in words how you got your answer.",
			correct_response: '0',
			response_type: "free"
	};

	var m_t9_in_1 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is the inverse of 5 under "+p_9+"?",
			correct_response: '4',
			response_type: "free"
	};

	var m_t9_in_2 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is the inverse of 2 under "+p_9+"?",
			correct_response: '7',
			response_type: "free"
	};

	var m_t9_in_3 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is the inverse of 0 under "+p_9+"?",
			correct_response: '0',
			response_type: "free"
	};

	var m_t9_ine_1 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is the inverse of 3 under "+p_9+"? Please explain in words how you got your answer.",
			correct_response: '',
			response_type: "free"
	};

	var m_t9_gee_1 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "Is 2 a generator under "+p_9+"? Please explain in words how you got your answer.",
			correct_response: "",
			response_type: "free"
	};

	var m_t9_gee_2 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "Is 3 a generator under "+p_9+"? Please explain in words how you got your answer.",
			correct_response: "",
			response_type: "free"
	};

	var m_t9_gee_3 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "Is 5 a generator under "+p_9+"? Please explain in words how you got your answer.",
			correct_response: "",
			response_type: "free"
	};

	var m_t9_gee_4 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "Is 6 a generator under "+p_9+"? Please explain in words how you got your answer.",
			correct_response: "",
			response_type: "free"
	};

	var m_t9_chunk = {
		chunk_type: 'linear',
		timeline: [m_t9_op_practice,m_t9_op_practice_f,m_t9_op_1,m_t9_op_2,m_t9_op_3,m_t9_op_4,m_t9_op_5,m_t9_explain_instructions,m_t9_ope_1,m_t9_ope_2,m_t9_ide_1,m_t9_in_1,m_t9_in_2,m_t9_in_3,m_t9_ine_1,m_t9_gee_1,m_t9_gee_2,m_t9_gee_3,m_t9_gee_4]
	};

	//ngon testing
 	var m_tn_instructions = {
		type: 'instructions',
		timing_post_trial: 0,
		text: "Now we'd like to ask you some questions about "+p_n+", where n could be any postive counting number. For example, n could be 3, or n could be any other counting number you can think of. If you need to write the operation, you can use \"+_n\", and your answers can include n to stand in for the arbitrary value if necessary." 
  	};

	var m_tn_op = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is 5 "+p_n+" 4?",
			correct_response: "Impossible to determine without knowing n.",
			response_type: "multi",
			response_choices: ["0","3","9","Impossible to determine without knowing n."]
	};

	var m_tn_in = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is the formula for the inverse of 1 under "+p_n+"?",
			correct_response: "n-1",
			response_type: "free"
	};

	var m_tn_ine = {
			type: "question",
			timing_post_trial: 0,
			prompt: "What is the formula for the inverse of an element x under "+p_n+"? Please explain in words how you got your answer.",
			correct_response: "n-x",
			response_type: "free"
	};

	var m_tn_gee_1 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "How can you test if an element x is a generator under "+p_n+"?.",
			correct_response: "",
			response_type: "free"
	};

	var m_tn_gee_2 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "Is there a pattern to which elements are generators? How can you know if an element x is a generator under "+p_n+" without seeing whether it can make all the elements?.",
			correct_response: "",
			response_type: "free"
	};

/*
	var m_tn_gee_3 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "We'd like you to answer the previous question again in multiple choice format as well. Pick the choice that seems most correct to you, even if it doesn't match your previous answer. Is there a pattern to which elements are generators? How can you know if an element x is a generator under "+p_n+" without seeing whether it can make all the elements?.",
			correct_response: "If x is not a multiple of a divisor of n, it is a generator.",
			response_type: "multi",
			response_choices: ["If x is an odd number, it is a generator.","If x does not divide n, it is a generator.", "If x is an even number, it is a generator.", "If x is not a multiple of a divisor of n, it is a generator.","There is no way to know without seeing whether x can make all the elements."]
	};
*/
	var m_tn_gee_3_1 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "True or false: If x is an odd number, it must be a generator under "+p_n+".",
			correct_response: "False",
			response_type: "multi",
			response_choices: ["True","False"]
	};

	var m_tn_gee_3_2 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "True or false: If x is an even number, it must not be a generator under "+p_n+".",
			correct_response: "False",
			response_type: "multi",
			response_choices: ["True","False"]
	};

	var m_tn_gee_3_3 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "True or false: If x is not a generator under "+p_n+", x must be a divisor of n, that is, x must divide n evenly, with no remainder.", 
			correct_response: "False",
			response_type: "multi",
			response_choices: ["True","False"]
	};

	var m_tn_gee_3_4 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "True or false: If x is not a generator under "+p_n+", x must be a multiple of a divisor of n. Please explain in words why your answer is correct.", 
			correct_response: "True",
			response_type: "free"
	};

	var m_tn_gee_4 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "If an element x is a generator under "+p_n+", is its inverse a generator under "+p_n+" always, sometimes, or never?",
			correct_response: "Always",
			response_type: "multi",
			response_choices: ["Always","Sometimes","Never"]
	};

	var m_tn_gee_5 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "if an element x is a generator under "+p_n+", is x "+p_n+" x a generator under "+p_n+" always, sometimes, or never? Please explain in words why your answer is correct.",
			correct_response: "sometimes",
			response_type: "free"
	};

	var m_tn_gee_6 = {
			type: "question",
			timing_post_trial: 0,
			prompt: "If an element x is not a generator under "+p_n+", is x "+p_n+" x a generator under "+p_n+" always, sometimes, or never?",
			correct_response: "Never",
			response_type: "multi",
			response_choices: ["Always","Sometimes","Never"]
	};

	var m_tn_chunk = {
		chunk_type: 'linear',
		timeline: [m_tn_in,m_tn_ine,m_tn_gee_2,m_tn_gee_3_1,m_tn_gee_3_2,m_tn_gee_3_3,m_tn_gee_3_4,m_tn_gee_4,m_tn_gee_5,m_tn_gee_6] //Removed m_tn_gee_1,m_tn_op
	};

	//What representation did you use chunk

	var m_r_chunk = {
		chunk_type: 'linear',
		timeline: [] 
	};

//Initialize//////////////////////////////////////////////////////////////////////////////////
        experiment_structure = [initial_page,m_op_instructions,m_op_instructions_2,m_tr_op_chunk,m_tr_op_backup_chunk,m_id_instructions,m_in_instructions,m_tr_in_chunk,m_scv_instructions,m_ge_instructions,m_tr_ge_chunk,m_t9_instructions,m_t9_chunk,m_tn_instructions,m_tn_chunk,bg_chunk,final_page];

	jsPsych.init({
		display_element: $('#jspsych-target'),
		experiment_structure: experiment_structure 
	});
	}
</script>
</html>
